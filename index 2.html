<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Encounter Lite ‚Äî –¥–µ–º–æ</title>
  <style>
    :root{
      --bg: #0b1020;
      --card: #121a33;
      --muted: #9aa4c7;
      --text: #e7ecff;
      --accent: #8ab4ff;
      --accent-2: #b38bff;
      --danger: #ff6b6b;
      --ok: #58d68d;
      --ring: rgba(138,180,255,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Noto Sans', 'Helvetica Neue', Arial, 'Apple Color Emoji','Segoe UI Emoji';
      color:var(--text); background: radial-gradient(1200px 600px at 20% -10%, #1d2752 0%, transparent 70%),
                                 radial-gradient(1200px 600px at 90% 110%, #3b195f 0%, transparent 70%),
                                 var(--bg);
      display:grid; place-items:center;
      padding: 32px 12px 56px;
    }
    .app{width:100%; max-width:880px}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,.35);
      overflow: hidden;
    }
    header{padding:22px 22px 0}
    .brand{display:flex; gap:12px; align-items:center}
    .logo{width:34px; height:34px; border-radius:12px; background: conic-gradient(from 0deg, var(--accent), var(--accent-2), var(--accent)); box-shadow: 0 0 0 4px rgba(255,255,255,.06)}
    .brand h1{margin:0; font-size:20px; letter-spacing:.2px}
    .sub{color:var(--muted); font-size:13px}
    .content{padding:22px; border-top:1px solid rgba(255,255,255,.06)}
    .stack{display:grid; gap:16px}
    .hidden{display:none}

    .level-title{font-size:18px; margin:0 0 6px}
    .task{line-height:1.65; color:#e9edff}
    .task p{margin:.4em 0}
    .task code{background:rgba(255,255,255,.06); padding:.2em .4em; border-radius:6px}

    .form{display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-top:6px}
    input[type="text"]{
      flex:1; min-width: 220px; font-size:16px; color:var(--text);
      background: #0e1630; border:1px solid rgba(255,255,255,.12); border-radius:14px; padding:14px 14px;
      outline:none; box-shadow: 0 0 0 0px var(--ring);
      transition: box-shadow .2s ease, border-color .2s ease, transform .08s ease;
    }
    input[type="text"]:focus{ border-color:var(--accent); box-shadow: 0 0 0 6px var(--ring)}
    button{
      cursor:pointer; border:none; padding:14px 16px; border-radius:14px; font-weight:600; letter-spacing:.2px;
      background: linear-gradient(180deg, var(--accent), #6ea1ff); color:#0b1020;
      box-shadow: 0 6px 24px rgba(138,180,255,.35);
      transition: transform .05s ease, box-shadow .2s ease, filter .2s ease;
    }
    button.secondary{background: linear-gradient(180deg, #313b64, #252e56); color:#d5ddff; box-shadow:none}
    button.ghost{background: transparent; color: var(--muted); border:1px dashed rgba(255,255,255,.15)}
    button:active{transform: translateY(1px)}

    .msg{font-size:14px}
    .msg.error{color: var(--danger)}
    .msg.ok{color: var(--ok)}

    .hint-wrap{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .hint{background: rgba(255,255,255,.06); padding:10px 12px; border-radius:12px; color:#d7dcff; font-size:14px}
    .muted{color:var(--muted)}

    footer{margin-top:14px; display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:12px}
    a.reset{color:var(--muted); text-decoration: underline dotted}

    .center{display:grid; place-items:center}
    .hero{padding:36px 22px 28px; text-align:center}
    .hero h2{margin:10px 0 6px; font-size:28px}
    .hero p{color:var(--muted)}

    .finish{padding:32px; text-align:center}
    .finish h3{font-size:24px; margin:0 0 8px}
  </style>
</head>
<body>
  <div class="app">
    <div class="card" id="screen-start">
      <header>
        <div class="brand"><div class="logo"></div><div><h1>Encounter¬†Lite</h1><div class="sub">–ú–∏–Ω–∏‚Äë–¥–≤–∏–∂–æ–∫ –¥–ª—è –∫–≤–µ—Å—Ç–æ–≤ ¬´–∫–∞–∫ –≤ EN¬ª ‚Äî –æ–¥–∏–Ω HTML‚Äë—Ñ–∞–π–ª</div></div></div>
      </header>
      <div class="content hero">
        <h2>–ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É</h2>
        <p>–ù–∞–∂–º–∏ ¬´–ù–∞—á–∞—Ç—å¬ª, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –¥–µ–º–æ –∏–∑ –¥–≤—É—Ö —É—Ä–æ–≤–Ω–µ–π. –ü–æ—Ç–æ–º —Ç—ã —Å–º–æ–∂–µ—à—å –∑–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç—ã/–∫–æ–¥—ã –≤ –∫–æ–¥–µ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ.</p>
        <div style="margin-top:18px" class="center">
          <div class="stack" style="min-width:280px">
            <button id="btnStart">–ù–∞—á–∞—Ç—å</button>
            <button class="secondary" id="btnContinue" style="display:none">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ</button>
            <button class="ghost" id="btnHow">–ö–∞–∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Ä–æ–≤–Ω–∏</button>
          </div>
        </div>
      </div>
      <div class="content" id="howto" style="display:none">
        <div class="stack">
          <div class="muted">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π:</div>
          <ol class="muted" style="line-height:1.65; padding-left:18px">
            <li>–û—Ç–∫—Ä–æ–π —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∏ –Ω–∞–π–¥–∏ –±–ª–æ–∫ <code>const LEVELS = [ ... ]</code>.</li>
            <li>–î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏–∑–º–µ–Ω–∏ <code>title</code>, <code>html</code> (–º–æ–∂–Ω–æ —Å —Ç–µ–≥–∞–º–∏) –∏ —Å–ø–∏—Å–æ–∫ <code>answers</code> (—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –∫–æ–¥—ã).</li>
            <li>–ö–æ–¥—ã —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞, <em>—ë</em>==<em>–µ</em>. –ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.</li>
            <li>–ü–æ–¥—Å–∫–∞–∑–∫–∏: —É —É—Ä–æ–≤–Ω—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ. –ó–∞–¥–∞—é—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º <code>hints</code>. –ö–Ω–æ–ø–∫–∞ ¬´–ü–æ–¥—Å–∫–∞–∑–∫–∞¬ª –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏—Ö –ø–æ –æ—á–µ—Ä–µ–¥–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π, –∑–∞–¥–∞–≤–∞–µ–º–æ–π –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏ <code>HINT_FIRST_DELAY_MS<\/code> –∏ <code>HINT_NEXT_DELAY_MS<\/code>.<\/li>
          </ol>
        </div>
      </div>
    </div>

    <div class="card hidden" id="screen-level">
      <header>
        <div class="brand"><div class="logo"></div><div><h1 id="gameTitle">Encounter¬†Lite</h1><div class="sub" id="subtitle">‚Äî</div></div></div>
      </header>
      <div class="content">
        <div class="stack">
          <h2 class="level-title" id="levelTitle"></h2>
          <div class="task" id="taskHtml"></div>
          <div class="form">
            <input type="text" id="answer" placeholder="–ö–æ–¥‚Ä¶" autocomplete="off" />
            <button id="btnSubmit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            <button id="btnHint" class="secondary" disabled>–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
          </div>
          <div class="msg error" id="msg" style="min-height:1.2em"></div>
          <div class="hint-wrap">
            <div class="muted" id="hintTimer"></div>
            <div id="hintsList" class="stack"></div>
          </div>
        </div>
        </div>
      </div>
      <div class="content">
        <footer>
          <div>–£—Ä–æ–≤–µ–Ω—å <span id="levelNum"></span>/<span id="levelTotal"></span></div>
          <a href="#" class="reset" id="btnReset">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</a>
        </footer>
      </div>
    </div>

    <div class="card hidden" id="screen-finish">
      <div class="finish">
        <h3>–§–∏–Ω–∏—à üéâ</h3>
        <p class="muted">–î–µ–º–æ –ø—Ä–æ–π–¥–µ–Ω–æ. –ó–∞–º–µ–Ω–∏—Ç–µ —É—Ä–æ–≤–Ω–∏ –Ω–∞ —Å–≤–æ–∏ ‚Äî –∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∏–≥—Ä—É.</p>
        <div style="margin-top:14px" class="center">
          <div class="stack" style="min-width:280px">
            <button id="btnRestart">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
            <button class="secondary" id="btnBackHome">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    // –ù–ê–°–¢–†–û–ô–ö–ò –ò –î–ê–ù–ù–´–ï –£–†–û–í–ù–ï–ô
    // –î–æ–±–∞–≤–ª—è–π—Ç–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —É—Ä–æ–≤–Ω–∏ –∑–¥–µ—Å—å. answers ‚Äî —Å–ø–∏—Å–æ–∫ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∫–æ–¥–æ–≤.
    // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–¥—ë—Ç –ø–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É –≤–∏–¥—É: –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä, –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤, —ë‚Üí–µ.

    const LEVELS = [
      {
        title: "–£—Ä–æ–≤–µ–Ω—å 1. –ü—Ä–æ–±–Ω—ã–π",
        html: `–≠—Ç–æ –¥–µ–º–æ. –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ <b>–∫–∏–ø–∏—à</b>, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –¥–∞–ª—å—à–µ.
<p class="muted">(–ó–¥–µ—Å—å –æ–±—ã—á–Ω–æ —Ç–µ–∫—Å—Ç –∑–∞–¥–∞–Ω–∏—è, –∫–∞—Ä—Ç–∏–Ω–∫–∞, –∞—É–¥–∏–æ –∏–ª–∏ —Å—Å—ã–ª–∫–∞.)</p>`,
        answers: ["–∫–∏–ø–∏—à", "kipish"],
        hints: [
          "–ù–∞–∑–≤–∞–Ω–∏–µ —Ö–∞—Ä—å–∫–æ–≤—Å–∫–æ–π –∫–æ–º–∞–Ω–¥—ã –∏–∑ EN.",
          "–ü–∏—à–µ—Ç—Å—è –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤; –ª–∞—Ç–∏–Ω–∏—Ü–µ–π —Ç–æ–∂–µ –ø–æ–¥–æ–π–¥—ë—Ç."
        ]
      },
      {
        title: "–£—Ä–æ–≤–µ–Ω—å 2. –ï—â—ë –æ–¥–∏–Ω –¥–µ–º–æ-—É—Ä–æ–≤–µ–Ω—å",
        html: `–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ <b>–º–µ–¥–≤–µ–¥—å</b> (–¥–µ–º–æ). <br><span class="muted">–ü–æ–¥—Å–∫–∞–∑–∫–∞ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ.</span>`,
        answers: ["–º–µ–¥–≤–µ–¥—å", "medved", "medved"],
        hints: [
          "–û–¥–∏–Ω –∏–∑ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —É–ø–æ–º—è–Ω—É—Ç—ã—Ö —Ç–æ–±–æ–π.",
          "–ö–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–æ–º –≤ –∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω–æ–º –ø–∞–¥–µ–∂–µ."
        ]
      }
      // –î–æ–±–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–æ –æ–±—Ä–∞–∑—Ü—É ‚Üë
    ];

    const GAME_TITLE = 'Encounter Lite';
    const HINT_FIRST_DELAY_MS = 30000; // –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ –ø–µ—Ä–≤–æ–π –ø–æ–¥—Å–∫–∞–∑–∫–∏ (–º—Å). 0 ‚Äî —Å—Ä–∞–∑—É
    const HINT_NEXT_DELAY_MS = 30000;  // –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ (–º—Å).
    const STORAGE_KEY = 'encounter-lite-progress-v1';

    // ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    // –ü–û–õ–ï–ó–ù–´–ï –§–£–ù–ö–¶–ò–ò
    const $ = (s) => document.querySelector(s);
    const $$ = (s) => Array.from(document.querySelectorAll(s));

    function normalize(str){
      return (str || '')
        .toString()
        .trim()
        .toLowerCase()
        .replace(/\s+/g,'')
        .replace(/—ë/g,'–µ')
        .replace(/["'`‚Äô]/g,'');
    }

    function loadProgress(){
      try { const idx = JSON.parse(localStorage.getItem(STORAGE_KEY)); return Number.isInteger(idx)? idx : 0; } catch { return 0; }
    }
    function saveProgress(idx){ localStorage.setItem(STORAGE_KEY, JSON.stringify(idx)); }
    function resetProgress(){ localStorage.removeItem(STORAGE_KEY); }

    function show(id){
      $$('#screen-start, #screen-level, #screen-finish').forEach(el=>el.classList.add('hidden'));
      $(id).classList.remove('hidden');
    }

    // ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    // –õ–û–ì–ò–ö–ê –ò–ì–†–´
    let current = 0;
    let nextHintIndex = 0;
    let nextHintTimeoutId = null;
    let countdownId = null;

    function startNew(){ current = 0; saveProgress(current); openLevel(current); }
    function continueGame(){ current = Math.min(loadProgress(), LEVELS.length); if(current >= LEVELS.length) finish(); else openLevel(current); }

    function openLevel(idx){
      const level = LEVELS[idx];
      if(!level){ finish(); return; }
      $('#gameTitle').textContent = GAME_TITLE;
      $('#subtitle').textContent = '–õ–æ–∫–∞–ª—å–Ω—ã–π –º–∏–Ω–∏‚Äë–∫–≤–µ—Å—Ç –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞';
      $('#levelTitle').textContent = level.title;
      $('#taskHtml').innerHTML = level.html.replace(/\n/g,'<br/>');
      $('#levelNum').textContent = idx + 1;
      $('#levelTotal').textContent = LEVELS.length;
      $('#answer').value = '';
      $('#msg').textContent = '';
      $('#hintText').classList.add('hidden');
      $('#hintText').textContent = '';
      $('#hintTimer').textContent = '';
      $('#btnHint').disabled = true;
      show('#screen-level');
      $('#answer').focus();

      // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥—Å–∫–∞–∑–æ–∫
      initHintsForLevel(level);
    }

    function submitAnswer(){
      const val = normalize($('#answer').value);
      const level = LEVELS[current];
      const ok = (level.answers||[]).map(normalize).includes(val);
      if(ok){
        $('#msg').textContent = '–í–µ—Ä–Ω–æ!';
        $('#msg').className = 'msg ok';
        current += 1; saveProgress(current);
        setTimeout(()=>{ current >= LEVELS.length ? finish() : openLevel(current); }, 350);
      } else {
        $('#msg').textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥';
        $('#msg').className = 'msg error';
      }
    }, 350);
      } else {
        $('#msg').textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥';
        $('#msg').className = 'msg error';
      }
    }

    function finish(){ show('#screen-finish'); }

    // ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    // –°–û–ë–´–¢–ò–Ø UI
    $('#btnStart').addEventListener('click', startNew);
    $('#btnContinue').addEventListener('click', continueGame);
    $('#btnRestart').addEventListener('click', startNew);
    $('#btnBackHome').addEventListener('click', ()=>show('#screen-start'));
    $('#btnSubmit').addEventListener('click', submitAnswer);
    $('#answer').addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ submitAnswer(); }});
    $('#btnHint').addEventListener('click', ()=>{ revealNextHint(); }); }
    });
    $('#btnReset').addEventListener('click', (e)=>{ e.preventDefault(); if(confirm('–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å?')){ resetProgress(); startNew(); }});
    $('#btnHow').addEventListener('click', ()=>{ const el=$('#howto'); el.style.display = (el.style.display==='none'||!el.style.display)?'block':'none'; });

    // ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    // –ü–ï–†–í–´–ô –ó–ê–ü–£–°–ö
    (function init(){
      const saved = loadProgress();
      if(Number.isInteger(saved) && saved>0 && saved<LEVELS.length){ $('#btnContinue').style.display='inline-block'; }
      show('#screen-start');
    })();

    // –ü–æ–¥—Å–∫–∞–∑–∫–∏ ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏
    function initHintsForLevel(level){
      clearTimeout(nextHintTimeoutId); nextHintTimeoutId=null;
      clearInterval(countdownId); countdownId=null;
      $('#hintsList').innerHTML='';
      $('#hintTimer').textContent='';
      nextHintIndex = 0;
      if(level.hints && level.hints.length){
        $('#btnHint').disabled = true;
        scheduleNextHint();
      } else {
        $('#btnHint').disabled = true;
      }
    }

    function scheduleNextHint(){
      const level = LEVELS[current];
      if(!level || !level.hints || nextHintIndex >= level.hints.length){ $('#btnHint').disabled = true; $('#hintTimer').textContent=''; return; }
      const delay = (nextHintIndex===0? HINT_FIRST_DELAY_MS : HINT_NEXT_DELAY_MS);
      if(!delay || delay<=0){ $('#btnHint').disabled = false; $('#hintTimer').textContent=''; return; }
      const t0 = Date.now();
      const target = t0 + delay;
      $('#btnHint').disabled = true;
      const tick = () => {
        const left = Math.max(0, Math.ceil((target - Date.now())/1000));
        $('#hintTimer').textContent = left>0 ? `–°–ª–µ–¥—É—é—â–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ —á–µ—Ä–µ–∑ ${left} —Å–µ–∫.` : '';
        if(left<=0){ clearInterval(countdownId); countdownId=null; $('#btnHint').disabled = false; }
      };
      tick();
      clearInterval(countdownId); countdownId = setInterval(tick, 250);
      clearTimeout(nextHintTimeoutId); nextHintTimeoutId = setTimeout(()=>{ clearInterval(countdownId); countdownId=null; $('#btnHint').disabled = false; $('#hintTimer').textContent=''; }, delay);
    }

    function revealNextHint(){
      const level = LEVELS[current];
      if(!level || !level.hints || nextHintIndex >= level.hints.length) return;
      const div = document.createElement('div');
      div.className = 'hint';
      div.textContent = level.hints[nextHintIndex];
      $('#hintsList').appendChild(div);
      nextHintIndex += 1;
      if(nextHintIndex < level.hints.length){ scheduleNextHint(); }
      else { $('#btnHint').disabled = true; $('#hintTimer').textContent=''; }
    }
  </script>
</body>
</html>
